(this["webpackJsonptango-insta_messenger"]=this["webpackJsonptango-insta_messenger"]||[]).push([[0],{31:function(e,t,n){},34:function(e,t,n){},35:function(e,t,n){},36:function(e,t,n){},41:function(e,t,n){},42:function(e,t,n){},43:function(e,t,n){},44:function(e,t,n){},45:function(e,t,n){},46:function(e,t,n){},47:function(e,t,n){},48:function(e,t,n){},49:function(e,t,n){},50:function(e,t,n){},51:function(e,t,n){"use strict";n.r(t);var s=n(0),c=n(1),a=n.n(c),r=n(13),i=n.n(r),o=n(4),u=n(9),l=n(2),d=Object(c.createContext)({isLoggedIn:!1,token:null,userId:null,login:function(){},logout:function(){}}),j=n(52);n(31);var O=function(e){var t=a.a.useRef();return Object(s.jsx)(j.a,{nodeRef:t,in:e.show,timeout:200,classNames:"slide-in-left",mountOnEnter:!0,unmountOnExit:!0,children:Object(s.jsx)("aside",{ref:t,className:"side-drawer",onClick:e.onClick,children:e.children})})},b=(n(34),function(e){return Object(s.jsx)("div",{className:"backdrop",onClick:e.onClick})});n(35);function p(){var e=Object(c.useContext)(d),t=Object(c.useState)(!1),n=Object(l.a)(t,2),a=n[0],r=n[1];function i(){r(!1)}return Object(s.jsxs)("header",{className:"main-page",children:[a&&Object(s.jsx)(b,{onClick:i}),Object(s.jsx)(O,{show:a,onClick:i,children:Object(s.jsx)("nav",{className:"main-navigation__drawer-nav",children:e.isLoggedIn&&Object(s.jsx)("button",{onClick:e.logout,children:"LOGOUT"})})}),Object(s.jsx)("h1",{children:"Tango"}),Object(s.jsx)("button",{className:"main-page_btn",onClick:function(){r(!0)},children:Object(s.jsx)("img",{src:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRtxtjn4FO15TqY7pnoNd-XE6uhcGpu3e_DYw&usqp=CAU",alt:"pic"})})]})}n(36);function h(){return Object(s.jsxs)("div",{className:"menu-bar",children:[Object(s.jsx)(u.b,{to:"/tango-insta_messenger/chats",children:Object(s.jsx)("div",{className:"chats",children:Object(s.jsx)("p",{children:"Chats"})})}),Object(s.jsx)(u.b,{to:"/tango-insta_messenger/friends",children:Object(s.jsx)("div",{className:"friends",children:Object(s.jsx)("p",{children:"Friends"})})}),Object(s.jsx)(u.b,{to:"/tango-insta_messenger/posts",children:Object(s.jsx)("div",{className:"posts",children:Object(s.jsx)("p",{children:"Posts"})})})]})}var m=n(3),f=n.n(m),x=n(8),v=n(6);n(41);var _=function(e){return Object(s.jsx)("div",{className:"card ".concat(e.className),style:e.style,children:e.children})},g=n(23),S="REQUIRE",E="MINLENGTH",T="MAXLENGTH",C="EMAIL",N=function(e,t){var n,s=!0,c=Object(g.a)(t);try{for(c.s();!(n=c.n()).done;){var a=n.value;a.type===S&&(s=s&&e.trim().length>0),a.type===E&&(s=s&&e.trim().length>=a.val),a.type===T&&(s=s&&e.trim().length<=a.val),"MIN"===a.type&&(s=s&&+e>=a.val),"MAX"===a.type&&(s=s&&+e<=a.val),a.type===C&&(s=s&&/^\S+@\S+\.\S+$/.test(e))}}catch(r){c.e(r)}finally{c.f()}return s};n(42);function R(e,t){switch(t.type){case"CHANGE":return Object(x.a)(Object(x.a)({},e),{},{value:t.val,isValid:N(t.val,t.validators)});case"TOUCH":return Object(x.a)(Object(x.a)({},e),{},{isTouched:!0});default:return e}}var P=function(e){var t=Object(c.useReducer)(R,{value:e.initialValue||"",isTouched:!1,isValid:e.initialValid||!1}),n=Object(l.a)(t,2),a=n[0],r=n[1],i=e.id,o=e.onInput,u=a.value,d=a.isValid;function j(t){r({type:"CHANGE",val:t.target.value,validators:e.validators})}function O(){r({type:"TOUCH"})}Object(c.useEffect)((function(){o(i,u,d)}),[i,u,d,o]);var b="imput"===e.element?Object(s.jsx)("input",{id:e.id,type:e.type,placeholder:e.placeholder,onChange:j,onBlur:O,value:a.value}):Object(s.jsx)("textarea",{id:e.id,rows:e.rows,onChange:j,onBlur:O,value:a.value});return Object(s.jsxs)("div",{className:"form-control ".concat(!a.isValid&&a.isTouched&&"form-control--invalid"),children:[Object(s.jsx)("label",{htmlFor:e.id,children:e.label}),b,!a.isValid&&a.isTouched&&Object(s.jsx)("p",{children:e.errorText})]})};n(43);var y=function(e){return e.href?Object(s.jsx)("a",{className:"button button--".concat(e.size||"default"," ").concat(e.inverse&&"button--inverse"," ").concat(e.danger&&"button--danger"),href:e.href,children:e.children}):e.to?Object(s.jsx)(u.b,{to:e.to,exact:e.exact,className:"button button--".concat(e.size||"default"," ").concat(e.inverse&&"button--inverse"," ").concat(e.danger&&"button--danger"),children:e.children}):Object(s.jsx)("button",{className:"button button--".concat(e.size||"default"," ").concat(e.inverse&&"button--inverse"," ").concat(e.danger&&"button--danger"),type:e.type,onClick:e.onClick,disabled:e.disabled,children:e.children})};n(44);function A(e){var t=Object(s.jsxs)("div",{className:"modal ".concat(e.className),style:e.style,children:[Object(s.jsx)("header",{className:"modal__header ".concat(e.headerClass),children:Object(s.jsx)("h2",{children:e.header})}),Object(s.jsxs)("form",{onSubmit:e.onSubmit?e.onSubmit:function(e){return e.preventDefault()},children:[Object(s.jsx)("div",{className:"modal__content ".concat(e.contentClass),children:e.children}),Object(s.jsx)("footer",{className:"modal__footer ".concat(e.footerClass),children:e.footer})]})]});return i.a.createPortal(t,document.getElementById("modal-hook"))}var D=function(e){return Object(s.jsxs)(a.a.Fragment,{children:[e.show&&Object(s.jsx)(b,{onClick:e.onCancel}),Object(s.jsx)(j.a,{nodeRef:a.a.useRef(null),in:e.show,mountOnEnter:!0,unmountOnExit:!0,timeout:200,classNames:"modal",children:Object(s.jsx)(A,Object(x.a)({},e))})]})},I=function(e){return Object(s.jsx)(D,{onCancel:e.onClear,header:"An Error Occurred!",show:!!e.error,footer:Object(s.jsx)(y,{onClick:e.onClear,children:"Okay"}),children:Object(s.jsx)("p",{children:e.error})})},k=(n(45),function(e){return Object(s.jsx)("div",{className:"".concat(e.asOverlay&&"loading-spinner__overlay"),children:Object(s.jsx)("div",{className:"lds-dual-ring"})})}),w=n(15);function L(e,t){switch(t.type){case"INPUT_CHANGE":var n=!0;for(var s in e.inputs)e.inputs[s]&&(n=s===t.inputId?n&&t.isValid:n&&e.inputs[s].isValid);return Object(x.a)(Object(x.a)({},e),{},{inputs:Object(x.a)(Object(x.a)({},e.inputs),{},Object(w.a)({},t.inputId,{value:t.value,isValid:t.isValid})),isValid:n});case"SET_DATA":return{inputs:t.inputs,isValid:t.formIsValid};default:return e}}function K(){var e=Object(c.useState)(!1),t=Object(l.a)(e,2),n=t[0],s=t[1],a=Object(c.useState)(),r=Object(l.a)(a,2),i=r[0],o=r[1],u=Object(c.useRef)([]),d=Object(c.useCallback)(function(){var e=Object(v.a)(f.a.mark((function e(t){var n,c,a,r,i,l,d=arguments;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=d.length>1&&void 0!==d[1]?d[1]:"GET",c=d.length>2&&void 0!==d[2]?d[2]:null,a=d.length>3&&void 0!==d[3]?d[3]:{},s(!0),r=new AbortController,u.current.push(r),e.prev=6,e.next=9,fetch(t,{method:n,body:c,headers:a,signal:r.signal});case 9:return i=e.sent,e.next=12,i.json();case 12:if(l=e.sent,u.current=u.current.filter((function(e){return e!==r})),i.ok){e.next=16;break}throw new Error(l.message);case 16:return s(!1),e.abrupt("return",l);case 20:throw e.prev=20,e.t0=e.catch(6),s(!1),o(e.t0.message),e.t0;case 25:case"end":return e.stop()}}),e,null,[[6,20]])})));return function(t){return e.apply(this,arguments)}}(),[]);return Object(c.useEffect)((function(){return function(){u.current.forEach((function(e){return e.abort()}))}}),[]),{isLoading:n,error:i,sendRequest:d,clearError:function(){o(null)}}}n(46);function U(){var e,t=Object(c.useContext)(d),n=Object(o.g)(),r=Object(c.useState)(!0),i=Object(l.a)(r,2),u=i[0],j=i[1],O=K(),b=O.isLoading,p=O.error,h=O.sendRequest,m=O.clearError,g=function(e,t){var n=Object(c.useReducer)(L,{inputs:e,isValid:t}),s=Object(l.a)(n,2),a=s[0],r=s[1];return[a,Object(c.useCallback)((function(e,t,n){r({type:"INPUT_CHANGE",value:t,isValid:n,inputId:e})}),[]),Object(c.useCallback)((function(e,t){r({type:"SET_DATA",inputs:e,formIsValid:t})}),[])]}({email:{value:"",isValid:!1},password:{value:"",isValid:!1}},!1),T=Object(l.a)(g,3),N=T[0],R=T[1],A=T[2];function D(){return(D=Object(v.a)(f.a.mark((function e(s){var c,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s.preventDefault(),!u){e.next=14;break}return e.prev=2,e.next=5,h("".concat(Object({NODE_ENV:"production",PUBLIC_URL:"/tango-insta_messenger",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_BACKEND_URL,"/auth/login"),"POST",JSON.stringify({email:N.inputs.email.value,password:N.inputs.password.value}),{"Content-Type":"application/json"});case 5:c=e.sent,t.login(c.userId,c.token),n.push("/tango-insta_messenger/chats"),e.next=12;break;case 10:e.prev=10,e.t0=e.catch(2);case 12:e.next=24;break;case 14:return e.prev=14,e.next=17,h("".concat(Object({NODE_ENV:"production",PUBLIC_URL:"/tango-insta_messenger",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_BACKEND_URL,"/auth/signup"),"POST",JSON.stringify({name:N.inputs.name.value,email:N.inputs.email.value,password:N.inputs.password.value}),{"Content-Type":"application/json"});case 17:a=e.sent,t.login(a.userId,a.token),n.push("/tango-insta_messenger/chats"),e.next=24;break;case 22:e.prev=22,e.t1=e.catch(14);case 24:case"end":return e.stop()}}),e,null,[[2,10],[14,22]])})))).apply(this,arguments)}return Object(s.jsxs)(a.a.Fragment,{children:[Object(s.jsx)(I,{error:p,onClear:function(){m()}}),Object(s.jsxs)(_,{className:"authentication",children:[b&&Object(s.jsx)("div",{className:"center",children:Object(s.jsx)(k,{asOverlay:!0})}),Object(s.jsx)("h2",{children:u?"LOGIN":"SIGNUP"}),Object(s.jsx)("hr",{}),Object(s.jsxs)("form",{onSubmit:function(e){return D.apply(this,arguments)},children:[!u&&Object(s.jsx)(P,{id:"name",element:"input",type:"text",label:"Name",validators:[{type:S}],errorText:"Please enter a name",onInput:R}),Object(s.jsx)(P,{id:"email",element:"input",type:"email",label:"E-Mail",validators:[{type:C}],errorText:"Please enter a valid email",onInput:R}),Object(s.jsx)(P,{id:"password",element:"input",type:"password",label:"Password",validators:[(e=6,{type:E,val:e})],errorText:"password should be min 6 characters",onInput:R}),Object(s.jsx)(y,{type:"submit",disabled:!N.isValid,children:u?"LOGIN":"SIGNUP"})]}),Object(s.jsxs)(y,{inverse:!0,onClick:function(){u?A(Object(x.a)(Object(x.a)({},N.inputs),{},{name:{value:"",isValid:!1}}),!1):A(Object(x.a)(Object(x.a)({},N.inputs),{},{name:void 0}),N.inputs.email.isValid&&N.inputs.password.isValid),j((function(e){return!e}))},children:["Switch to ",u?"SIGNUP":"LOGIN"]})]})]})}function H(e){var t=Object(c.useContext)(d),n=K(),r=n.isLoading,i=n.error,o=n.sendRequest,j=n.clearError,O=Object(c.useState)(),b=Object(l.a)(O,2),p=b[0],h=b[1];return Object(c.useEffect)((function(){function n(){return(n=Object(v.a)(f.a.mark((function n(){var s,c,a;return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o("".concat(Object({NODE_ENV:"production",PUBLIC_URL:"/tango-insta_messenger",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_BACKEND_URL,"/message/").concat(e.userId));case 2:return s=n.sent,c=s.users.filter((function(e){return e!==t.userId})),n.next=6,o("".concat(Object({NODE_ENV:"production",PUBLIC_URL:"/tango-insta_messenger",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_BACKEND_URL,"/user/").concat(c));case 6:a=n.sent,h({id:a.id,name:a.name});case 8:case"end":return n.stop()}}),n)})))).apply(this,arguments)}!function(){n.apply(this,arguments)}()}),[t.userId,o,e.userId]),Object(s.jsxs)(a.a.Fragment,{children:[Object(s.jsx)(I,{error:i,onClear:j}),r&&Object(s.jsx)(k,{}),p&&Object(s.jsxs)("div",{className:"chat-box",children:[Object(s.jsx)("img",{className:"friend-image",alt:"friend-img",src:"https://picsum.photos/200/200"}),Object(s.jsx)(u.b,{to:"/tango-insta_messenger/chats/".concat(p.id),className:"friend-info-a",children:Object(s.jsxs)("div",{className:"friend-info",children:[Object(s.jsxs)("h5",{className:"friend-name",children:["Name : ",p.name]}),Object(s.jsxs)("p",{className:"friend-msg",children:["Message: ",p.lastMsg," "]})]})})]})]})}n(47);function V(e){var t=Object(c.useContext)(d),n=Object(c.useState)([]),a=Object(l.a)(n,2),r=a[0],i=a[1],o=K(),u=o.isLoading,j=o.error,O=o.sendRequest,b=o.clearError;return Object(c.useEffect)((function(){function e(){return(e=Object(v.a)(f.a.mark((function e(){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O("".concat(Object({NODE_ENV:"production",PUBLIC_URL:"/tango-insta_messenger",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_BACKEND_URL,"/user/").concat(t.userId));case 3:n=e.sent,i(n.messages),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}t.userId&&function(){e.apply(this,arguments)}()}),[t.userId,O]),Object(s.jsxs)("div",{className:"all-chat",children:[Object(s.jsx)(I,{error:j,onClear:b}),u&&Object(s.jsx)("div",{className:"center",children:Object(s.jsx)(k,{})}),0!==r.length&&r.map((function(e,t){return Object(s.jsx)(H,{userId:e},t)}))]})}n(48);function F(e){var t=Object(c.useContext)(d),n=Object(o.h)().userId,a=Object(c.useState)(),r=Object(l.a)(a,2),i=r[0],j=r[1],O=Object(c.useState)([]),b=Object(l.a)(O,2),p=b[0],h=b[1],m=Object(c.useState)(),x=Object(l.a)(m,2),_=x[0],g=x[1],S=Object(c.useState)(),E=Object(l.a)(S,2),T=E[0],C=E[1],N=K(),R=N.error,P=N.sendRequest,y=N.clearError;function A(){return(A=Object(v.a)(f.a.mark((function e(n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,P("".concat(Object({NODE_ENV:"production",PUBLIC_URL:"/tango-insta_messenger",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_BACKEND_URL,"/message/").concat(T),"POST",JSON.stringify({time:"2021-04-01",sender:t.userId,message:n.target.inputMsg.value}),{"Content-Type":"application/json"});case 3:j((function(e){return!e})),n.target.inputMsg.value="";case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(c.useEffect)((function(){function e(){return(e=Object(v.a)(f.a.mark((function e(){var s,c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h([]),e.next=3,P("".concat(Object({NODE_ENV:"production",PUBLIC_URL:"/tango-insta_messenger",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_BACKEND_URL,"/message"),"POST",JSON.stringify({user:t.userId,friend:n}),{"Content-Type":"application/json"});case 3:return s=e.sent,e.next=6,P("".concat(Object({NODE_ENV:"production",PUBLIC_URL:"/tango-insta_messenger",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_BACKEND_URL,"/user/").concat(n));case 6:c=e.sent,g({name:c.name}),C(s._id),h((function(e){return e.concat(s.messages)}));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[t.userId,n,P,i]),Object(s.jsxs)("div",{className:"messenger-box",children:[Object(s.jsx)(I,{error:R,clearError:y}),_&&Object(s.jsxs)("header",{className:"messenger-header",children:[Object(s.jsx)(u.b,{to:"/tango-insta_messenger/chats",children:Object(s.jsx)("button",{type:"backButton",onClick:e.onClick,children:Object(s.jsx)("p",{children:"\u2190"})})}),Object(s.jsx)("img",{className:"friend-image",alt:"friend-img",src:"https://picsum.photos/200/200"}),Object(s.jsx)("div",{children:Object(s.jsxs)("h1",{children:[_.name," "]})})]}),Object(s.jsxs)("div",{className:"messages",children:[Object(s.jsx)("div",{className:"all-chats",children:0!==p.length&&p.map((function(e,n){return Object(s.jsx)("div",{children:Object(s.jsx)("p",{className:e.sender===t.userId?"right":"left",children:e.message})},n)}))}),Object(s.jsxs)("div",{className:"textfield",children:[Object(s.jsx)("span",{children:Object(s.jsx)("p",{children:"\ud83d\ude0a"})}),Object(s.jsxs)("form",{className:"textfield-form",onSubmit:function(e){return A.apply(this,arguments)},children:[Object(s.jsx)("input",{type:"text",id:"inputMsg"}),Object(s.jsx)("button",{type:"submit"})]}),Object(s.jsx)("span",{children:Object(s.jsx)("p",{children:"\ud83d\udcce"})}),Object(s.jsx)("span",{children:Object(s.jsx)("p",{children:"\ud83d\udcf7"})})]})]})]})}function W(e){var t=Object(c.useState)(),n=Object(l.a)(t,2),r=n[0],i=n[1],o=K(),d=o.error,j=o.sendRequest,O=o.clearError;return Object(c.useEffect)((function(){function t(){return(t=Object(v.a)(f.a.mark((function t(){var n;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,j("".concat(Object({NODE_ENV:"production",PUBLIC_URL:"/tango-insta_messenger",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_BACKEND_URL,"/user/").concat(e.userId));case 3:n=t.sent,i({id:n.id,name:n.name}),t.next=9;break;case 7:t.prev=7,t.t0=t.catch(0);case 9:case"end":return t.stop()}}),t,null,[[0,7]])})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[e.userId,j]),Object(s.jsx)(a.a.Fragment,{children:r&&Object(s.jsxs)("div",{className:"chat-box",children:[Object(s.jsx)(I,{error:d,onClear:O}),Object(s.jsx)("img",{className:"friend-image",alt:"friend-img",src:"https://picsum.photos/200/200"}),Object(s.jsx)(u.b,{to:"/tango-insta_messenger/chats/".concat(r.id),className:"friend-info-a",children:Object(s.jsx)("div",{className:"friend-info",children:Object(s.jsx)("h5",{className:"friend-name",children:r.name})})})]})})}function B(e){var t=Object(c.useContext)(d),n=K(),a=n.error,r=n.sendRequest,i=n.clearError;function o(){return(o=Object(v.a)(f.a.mark((function n(s){var c;return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s.preventDefault(),c=s.target.email.value,n.prev=2,n.next=5,r("".concat(Object({NODE_ENV:"production",PUBLIC_URL:"/tango-insta_messenger",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_BACKEND_URL,"/user/").concat(t.userId,"/friend"),"POST",JSON.stringify({email:c}),{"Content-Type":"application/json"});case 5:e.reloadFetch((function(e){return!e})),s.target.email.value="",n.next=11;break;case 9:n.prev=9,n.t0=n.catch(2);case 11:case"end":return n.stop()}}),n,null,[[2,9]])})))).apply(this,arguments)}return Object(s.jsxs)("div",{children:[Object(s.jsx)(I,{error:a,onClear:i}),Object(s.jsxs)("form",{onSubmit:function(e){return o.apply(this,arguments)},children:[Object(s.jsx)("label",{htmlFor:"email",children:"Email"}),Object(s.jsx)("input",{type:"email",id:"email",name:"email"}),Object(s.jsx)("button",{type:"submit",children:"AddFriend"})]})]})}var G;n(49);function M(e){var t=Object(c.useContext)(d),n=K(),a=n.isLoading,r=n.error,i=n.sendRequest,o=n.clearError,u=Object(c.useState)([]),j=Object(l.a)(u,2),O=j[0],b=j[1],p=Object(c.useState)(!1),h=Object(l.a)(p,2),m=h[0],x=h[1];return Object(c.useEffect)((function(){function e(){return(e=Object(v.a)(f.a.mark((function e(){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,b([]),e.next=4,i("".concat(Object({NODE_ENV:"production",PUBLIC_URL:"/tango-insta_messenger",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_BACKEND_URL,"/user/").concat(t.userId));case 4:n=e.sent,b(n.friends),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}t.userId&&function(){e.apply(this,arguments)}()}),[t.userId,i,m]),Object(s.jsxs)("div",{className:"all-chat",children:[Object(s.jsx)(B,{reloadFetch:x}),Object(s.jsx)(I,{error:r,onClear:o}),a&&Object(s.jsx)("div",{className:"center",children:Object(s.jsx)(k,{})}),0!==O.length&&O.map((function(e,t){return Object(s.jsx)(W,{userId:e},t)}))]})}function q(){return Object(s.jsx)("div",{children:Object(s.jsx)("h1",{children:"Posts appear here"})})}n(50);var J=function(){var e,t=function(){var e=Object(c.useState)(!1),t=Object(l.a)(e,2),n=t[0],s=t[1],a=Object(c.useState)(),r=Object(l.a)(a,2),i=r[0],o=r[1],u=Object(c.useState)(),d=Object(l.a)(u,2),j=d[0],O=d[1],b=Object(c.useCallback)((function(e,t,n){s(t),O(e);var c=n||new Date((new Date).getTime()+36e5);o(c),localStorage.setItem("userData",JSON.stringify({userId:e,token:t,expiration:c.toISOString()}))}),[]),p=Object(c.useCallback)((function(){s(null),o(null),O(null),localStorage.removeItem("userData")}),[]);return Object(c.useEffect)((function(){if(n&&i){var e=i.getTime()-(new Date).getTime();G=setTimeout(p,e)}else clearTimeout(G)}),[n,p,i]),Object(c.useEffect)((function(){var e=JSON.parse(localStorage.getItem("userData"));e&&e.token&&new Date(e.expiration)>new Date&&b(e.userId,e.token,new Date(e.expiration))}),[b]),{token:n,login:b,logout:p,userId:j}}(),n=t.token,a=t.login,r=t.logout,i=t.userId;return e=n?Object(s.jsxs)(o.d,{children:[Object(s.jsxs)(o.b,{path:"/tango-insta_messenger/chats",exact:!0,children:[Object(s.jsx)(h,{}),Object(s.jsx)(V,{})]}),Object(s.jsxs)(o.b,{path:"/tango-insta_messenger/friends",exact:!0,children:[Object(s.jsx)(h,{}),Object(s.jsx)(M,{})]}),Object(s.jsxs)(o.b,{path:"/tango-insta_messenger/posts",exact:!0,children:[Object(s.jsx)(h,{}),Object(s.jsx)(q,{})]}),Object(s.jsxs)(o.b,{path:"/tango-insta_messenger/chats/:userId",exact:!0,children:[Object(s.jsx)(h,{}),Object(s.jsx)(F,{})]}),Object(s.jsx)(o.a,{to:"/tango-insta_messenger/chats"})]}):Object(s.jsxs)(o.d,{children:[Object(s.jsx)(o.b,{path:"/tango-insta_messenger",exact:!0,children:Object(s.jsx)(U,{})}),Object(s.jsx)(o.a,{to:"/tango-insta_messenger"})]}),Object(s.jsx)(d.Provider,{value:{isLoggedIn:!!n,token:n,userId:i,login:a,logout:r},children:Object(s.jsxs)(u.a,{children:[Object(s.jsx)(p,{}),Object(s.jsx)(c.Suspense,{fallback:Object(s.jsx)("div",{className:"center",children:Object(s.jsx)(k,{asOverlay:!0})}),children:e})]})})};i.a.render(Object(s.jsx)(a.a.StrictMode,{children:Object(s.jsx)(J,{})}),document.getElementById("root"))}},[[51,1,2]]]);
//# sourceMappingURL=main.4f85ad9b.chunk.js.map